ã‹ã—ã“ã¾ã‚Šã¾ã—ãŸã€‚
ä»¥ä¸‹ã«ã€\*\*Project 10k â†’ 1M ã«ãŠã‘ã‚‹ã€Œãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã¾ã§ã®æœ€æ–°æ‰‹é †ã€\*\*ã‚’ã€Colabãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ä¸¡å¯¾å¿œã®æ§‹æˆã«åŸºã¥ã„ã¦ã€**åˆå¿ƒè€…ã«ã‚‚åˆ†ã‹ã‚Šã‚„ã™ããƒ»ã‚³ãƒ¼ãƒ‰è§£èª¬ä»˜ãã§**ã¾ã¨ã‚ã¾ã™ã€‚

---

# âœ… ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã¾ã§ã®å®Œå…¨æ‰‹é †ï¼ˆ2025å¹´6æœˆæœ€æ–°ç‰ˆï¼‰

---

## ğŸ”· å…¨ä½“ã®æµã‚Œï¼ˆ6ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

| ã‚¹ãƒ†ãƒƒãƒ— | å‡¦ç†          | ãƒ•ã‚¡ã‚¤ãƒ«å                             | å‡ºåŠ›                        |
| ---- | ----------- | --------------------------------- | ------------------------- |
| 1    | MT5ã‹ã‚‰ç”Ÿãƒ‡ãƒ¼ã‚¿å–å¾— | `fetch_and_label.py`              | raw/ ã‚·ãƒ³ãƒœãƒ«åˆ¥CSV             |
| 2    | ç‰¹å¾´é‡ç”Ÿæˆ       | `generate_features.py`            | processed/selfeat\_...csv |
| 3    | ãƒ¢ãƒ‡ãƒ«å­¦ç¿’       | `train_model.py`                  | model.pkl + features.json |
| 4    | ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ    | `backtest.py`                     | equityã‚°ãƒ©ãƒ•ï¼ˆ.pngï¼‰           |
| 5    | è‡ªå‹•ãƒ‘ã‚¹ç®¡ç†      | `config.yaml` + `utils/common.py` | OSã”ã¨ã®ä¿å­˜å…ˆåˆ‡æ›¿                |
| 6    | ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹è§£æ±º   | `sys.path.insert(...)`            | utilsèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼å›é¿            |

---

## ğŸ—‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆé‡è¦ï¼‰

```
project_10k_to_1m/
â”œâ”€ config.yaml
â”œâ”€ src/
â”‚   â”œâ”€ data/
â”‚   â”‚   â”œâ”€ fetch_and_label.py
â”‚   â”‚   â””â”€ generate_features.py
â”‚   â”œâ”€ models/
â”‚   â”‚   â”œâ”€ train_model.py
â”‚   â”‚   â””â”€ backtest.py
â”‚   â””â”€ utils/
â”‚       â”œâ”€ __init__.py   â† ç©ºã§OKï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èªè­˜ç”¨ï¼‰
â”‚       â””â”€ common.py     â† ãƒ‘ã‚¹åˆ‡ã‚Šæ›¿ãˆé–¢æ•°ã‚’å®šç¾©
â””â”€ project_10k_to_1m_data/
    â”œâ”€ raw/         â† ç”Ÿãƒ‡ãƒ¼ã‚¿
    â””â”€ processed/   â† ç‰¹å¾´é‡ãƒ»ãƒ¢ãƒ‡ãƒ«ãƒ»ãƒ†ã‚¹ãƒˆçµæœ
```

---

## âœ… 1. ç”Ÿãƒ‡ãƒ¼ã‚¿å–å¾— `fetch_and_label.py`

```bash
python src/data/fetch_and_label.py --symbol USDJPY --timeframe M5 --bars 100000
```

### ğŸ” è§£èª¬ï¼š

* MetaTrader 5 APIã‹ã‚‰ã€ãƒ­ãƒ¼ã‚½ã‚¯è¶³ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
* `project_10k_to_1m_data/raw/USDJPY/M5/` ã«CSVã‚’ä¿å­˜
* ãƒ•ã‚¡ã‚¤ãƒ«åã«**ã‚·ãƒ³ãƒœãƒ«ãƒ»æ™‚é–“è¶³ãƒ»ãƒãƒ¼æ•°ãƒ»ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—**ã‚’å«ã‚€

---

## âœ… 2. ç‰¹å¾´é‡ç”Ÿæˆ `generate_features.py`

```bash
python src/data/generate_features.py --symbol USDJPY --timeframe M5 --bars 100000
```

### ğŸ” è§£èª¬ï¼š

* ã€Œä¾¡æ ¼å¤‰åŒ–ã€ã€Œç§»å‹•å¹³å‡ã€ã€ŒRSIã€ãªã©ã®ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ã‚’è¨ˆç®—
* `processed/USDJPY/M5/selfeat_...csv` ã«ä¿å­˜
* ãƒ‡ãƒ¼ã‚¿ã« `label` ãŒå«ã¾ã‚Œã¦ã„ãªã‘ã‚Œã°ã€`return > 0` ã‚’è²·ã„ã¨ã¿ãªã—ã¦è‡ªå‹•ç”Ÿæˆ

---

## âœ… 3. ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ `train_model.py`

```bash
python src/models/train_model.py --symbol USDJPY --timeframe M5 --bars 100000
```

### ğŸ” è§£èª¬ï¼š

* æœ€æ–°ã®ç‰¹å¾´é‡CSVã‚’èª­ã¿è¾¼ã¿ã€XGBoostã§å­¦ç¿’
* `train_test_split()` ã§æ™‚ç³»åˆ—é †ã«åˆ†å‰²ã—ã€**æœªæ¥ã‚’ä½¿ã‚ãªã„**
* å‡ºåŠ›ï¼š

  * `xgb_model_....pkl`ï¼ˆãƒ¢ãƒ‡ãƒ«æœ¬ä½“ï¼‰
  * `..._features.json`ï¼ˆä½¿ç”¨ã—ãŸç‰¹å¾´é‡ã®ãƒªã‚¹ãƒˆï¼‰

---

## âœ… 4. ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆ `backtest.py`

```bash
python src/models/backtest.py --symbol USDJPY --timeframe M5 --bars 100000
```

### ğŸ” è§£èª¬ï¼š

* å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã§äºˆæ¸¬ï¼ˆ`predict_proba`ï¼‰
* `0.5` ã‚’é–¾å€¤ã«ã—ã¦è²·ã„ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚’åˆ¤å®š â†’ `return` ã‚’ç©ç®—
* æç›Šã‚’ç´¯ç©ã—ã¦ \*\*ã‚¨ã‚¯ã‚¤ãƒ†ã‚£ã‚«ãƒ¼ãƒ–ï¼ˆè³‡ç”£æ¨ç§»ï¼‰\*\*ã‚’ä½œæˆ
* å‡ºåŠ›å…ˆï¼š
  `processed/USDJPY/M5/backtest_...png`

---

## âœ… 5. `config.yaml` ã«ã‚ˆã‚‹ä¿å­˜å…ˆç®¡ç†

```yaml
data_root_local: C:/Projects/project_10k_to_1m_data
data_root_colab: project_10k_to_1m_data  # MyDriveç›´ä¸‹ã‚’æƒ³å®š
```

* ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼šWindowsç”¨ã®çµ¶å¯¾ãƒ‘ã‚¹
* Colabç’°å¢ƒï¼šGoogle Drive ç›´ä¸‹ã‚’æŒ‡å®š

---

## âœ… 6. `utils/common.py` ã«ã‚ˆã‚‹ãƒ‘ã‚¹åˆ‡ã‚Šæ›¿ãˆé–¢æ•°

```python
def resolve_data_root(cfg):
    if "google.colab" in sys.modules:
        return Path("/content/drive/MyDrive") / cfg["data_root_colab"]
    else:
        return Path(cfg["data_root_local"]).resolve()
```

* ã©ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚‚ `load_config()` â†’ `resolve_data_root(cfg)` ã§è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
* ã‚³ãƒ¼ãƒ‰å´ã¯ä¸€åˆ‡ä¿å­˜å…ˆã‚’æ„è­˜ã›ãšOK

---

## âœ… å„ã‚¹ã‚¯ãƒªãƒ—ãƒˆå…±é€šï¼šã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹æŒ¿å…¥

```python
import sys
from pathlib import Path
sys.path.insert(0, str(Path(__file__).resolve().parents[1]))  # src/ ã‚’é€šã™
from utils.common import load_config, resolve_data_root
```

ã“ã‚Œã«ã‚ˆã‚Šã€`from utils.common import ...` ãŒã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã›ã‚“ã€‚

---

## âœ… ã¾ã¨ã‚ï¼ˆå†æ²ï¼‰

| ã‚¹ãƒ†ãƒƒãƒ—       | å‡¦ç†å†…å®¹        | å…¥åŠ›              | å‡ºåŠ›              |
| ---------- | ----------- | --------------- | --------------- |
| â‘  fetch    | MT5ã‹ã‚‰CSVä¿å­˜  | MT5 API         | raw/xxx.csv     |
| â‘¡ feature  | ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ç‰¹å¾´é‡ä½œæˆ  | raw/            | selfeat\_...csv |
| â‘¢ train    | ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ãƒ»ä¿å­˜    | selfeat\_...csv | .pkl + .json    |
| â‘£ backtest | ãƒ¢ãƒ‡ãƒ«æ¨è«–ï¼†æç›Šå¯è¦–åŒ– | ä¸Šè¨˜              | .png            |
| â‘¤ config   | ä¿å­˜å…ˆä¸€å…ƒç®¡ç†     | config.yaml     | ãƒ«ãƒ¼ãƒˆåˆ‡æ›¿           |
| â‘¥ path     | ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹çµ±ä¸€   | utils/          | ã©ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚‚OK     |

---

ã”å¸Œæœ›ã‚ã‚Œã°ï¼š

* `manifest.csv` è‡ªå‹•ç”Ÿæˆ
* `backtest_result.json`ï¼ˆSharpe, DD, å‹ç‡ï¼‰è¿½åŠ 
* Colabç”¨ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

ã‚‚å³ã”æä¾›ã§ãã¾ã™ã€‚ã©ã†ãæ¬¡ã®ã”æŒ‡ç¤ºã‚’ãŠèã‹ã›ãã ã•ã„ã€‚
